-- Schema for Employee Duty Allocation
CREATE TABLE Empl (
    e_no INT PRIMARY KEY,
    e_name VARCHAR(50),
    post VARCHAR(50),
    pay_rate DECIMAL(10, 2)
);

CREATE TABLE Position (
    pos_no INT PRIMARY KEY,
    post VARCHAR(50)
);

CREATE TABLE Duty_alloc (
    pos_no INT,
    e_no INT,
    month INT,
    year INT,
    shift VARCHAR(20),
    FOREIGN KEY (pos_no) REFERENCES Position(pos_no),
    FOREIGN KEY (e_no) REFERENCES Empl(e_no)
);

-- Queries for Chit 25
-- 1. Get duty allocation for e_no 123 for the first shift in April 2003
SELECT * FROM Duty_alloc 
WHERE e_no = 123 AND month = 4 AND year = 2003 AND shift = 'first';

-- 2. Get employees with a pay rate >= 'Sachin's' pay rate
SELECT e_name FROM Empl 
WHERE pay_rate >= (SELECT pay_rate FROM Empl WHERE e_name = 'Sachin');

-- 3. Create a view for min, max, avg salary by post
CREATE VIEW SalaryStats AS 
SELECT post, MIN(pay_rate) AS min_salary, MAX(pay_rate) AS max_salary, AVG(pay_rate) AS avg_salary 
FROM Empl GROUP BY post;

-- 4. Count employees in each shift with post 'manager'
SELECT shift, COUNT(*) AS manager_count FROM Duty_alloc 
JOIN Position ON Duty_alloc.pos_no = Position.pos_no 
WHERE Position.post = 'manager' 
GROUP BY shift;
